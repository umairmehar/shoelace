import{r as t,c as s,h as i,g as l}from"./p-25e7eff4.js";import{g as e}from"./p-7d14e290.js";import{i as h}from"./p-6a284815.js";let a=0;const n=class{constructor(i){t(this,i),this.slChange=s(this,"slChange",7),this.slFocus=s(this,"slFocus",7),this.slBlur=s(this,"slBlur",7),this.inputId="select-"+ ++a,this.labelId="select-label-"+a,this.helpTextId="select-help-text-"+a,this.hasFocus=!1,this.isOpen=!1,this.items=[],this.displayLabel="",this.displayTags=[],this.multiple=!1,this.maxTagsVisible=3,this.disabled=!1,this.name="",this.placeholder="",this.size="medium",this.hoist=!1,this.value="",this.pill=!1,this.label="",this.clearable=!1,this.valid=!1,this.invalid=!1}handleMultipleChange(){const t=this.getValueAsArray();this.value=this.multiple?t:t[0]||"",this.syncItemsFromValue()}handleValueChange(){this.syncItemsFromValue(),this.slChange.emit()}connectedCallback(){this.handleBlur=this.handleBlur.bind(this),this.handleFocus=this.handleFocus.bind(this),this.handleClear=this.handleClear.bind(this),this.handleKeyDown=this.handleKeyDown.bind(this),this.handleLabelClick=this.handleLabelClick.bind(this),this.handleMenuKeyDown=this.handleMenuKeyDown.bind(this),this.handleMenuHide=this.handleMenuHide.bind(this),this.handleMenuShow=this.handleMenuShow.bind(this),this.handleMenuSelect=this.handleMenuSelect.bind(this),this.handleSlotChange=this.handleSlotChange.bind(this)}componentDidLoad(){this.menu.querySelector("slot").addEventListener("slotchange",this.handleSlotChange),this.resizeObserver=new h(()=>this.resizeMenu()),this.reportDuplicateItemValues(),requestAnimationFrame(()=>this.syncItemsFromValue())}disconnectedCallback(){this.menu.querySelector("slot").removeEventListener("slotchange",this.handleSlotChange)}getItemLabel(t){const s=t.shadowRoot.querySelector("slot:not([name])");return e(s)}getItems(){return[...this.host.querySelectorAll("sl-menu-item")]}getValueAsArray(){return Array.isArray(this.value)?this.value:[this.value]}handleBlur(){this.hasFocus=!1,this.slBlur.emit()}handleFocus(){this.hasFocus=!0,this.slFocus.emit(),this.input.setSelectionRange(0,0)}handleClear(){this.value=this.multiple?[]:"",this.syncItemsFromValue(),this.dropdown.hide()}handleKeyDown(t){if(!this.isOpen&&"Enter"===t.key&&t.target===this.input)return this.dropdown.show(),void t.preventDefault()}handleLabelClick(){this.input.setFocus()}handleMenuKeyDown(t){if("Escape"===t.key||"Tab"===t.key)return this.dropdown.hide(),void t.preventDefault()}handleMenuSelect(t){const s=t.detail.item;this.value=this.multiple?this.value.includes(s.value)?this.value.filter(t=>t!==s.value):[...this.value,s.value]:s.value,this.syncItemsFromValue()}handleMenuShow(t){this.disabled?t.preventDefault():(this.resizeMenu(),this.resizeObserver.observe(this.host),this.isOpen=!0)}handleMenuHide(){this.resizeObserver.unobserve(this.host),this.isOpen=!1,this.input.setFocus()}handleSlotChange(){this.syncItemsFromValue(),this.reportDuplicateItemValues()}reportDuplicateItemValues(){const t=this.getItems().map(t=>t.value).filter((t,s,i)=>i.indexOf(t)!==s);if(t.length)throw new Error('Duplicate value found on <sl-menu-item> in <sl-select>: "'+t.join('", "')+'"')}resizeMenu(){this.menu.style.width=this.input.clientWidth+"px"}syncItemsFromValue(){const t=this.getItems(),s=this.getValueAsArray();if(t.map(t=>t.checked=s.includes(t.value)),this.multiple){const l=[];if(s.map(s=>t.map(t=>t.value===s?l.push(t):null)),this.displayTags=l.map(t=>i("sl-tag",{exportparts:"base:tag",type:"info",size:this.size,pill:this.pill,clearable:!0,onClick:t=>t.stopPropagation(),onSlClear:s=>{s.stopPropagation(),t.checked=!1,this.syncValueFromItems()}},this.getItemLabel(t))),this.maxTagsVisible>0&&this.displayTags.length>this.maxTagsVisible){const t=this.displayTags.length;this.displayTags=this.displayTags.slice(0,this.maxTagsVisible),this.displayTags.push(i("sl-tag",{exportparts:"base:tag",type:"info",size:this.size},"+",t-this.maxTagsVisible))}this.displayLabel=""}else{const i=t.filter(t=>t.value===s[0])[0];this.displayLabel=i?this.getItemLabel(i):"",this.displayTags=[]}}syncValueFromItems(){const t=this.getItems().filter(t=>t.checked).map(t=>t.value);this.value=this.multiple?this.value.filter(s=>t.includes(s)):t.length>0?t[0]:""}render(){return i("div",{part:"form-control",class:{"form-control":!0,"form-control--has-label":this.label.length>0,"form-control--valid":this.valid,"form-control--invalid":this.invalid}},i("label",{part:"label",id:this.labelId,class:{label:!0,"label--small":"small"===this.size,"label--medium":"medium"===this.size,"label--large":"large"===this.size,"label--valid":this.valid,"label--invalid":this.invalid},htmlFor:this.inputId,onClick:this.handleLabelClick},this.label),i("sl-dropdown",{part:"base",ref:t=>this.dropdown=t,hoist:this.hoist,closeOnSelect:!this.multiple,containingElement:this.host,class:{select:!0,"select--open":this.isOpen,"select--empty":0===this.value.length,"select--focused":this.hasFocus,"select--disabled":this.disabled,"select--multiple":this.multiple,"select--small":"small"===this.size,"select--medium":"medium"===this.size,"select--large":"large"===this.size,"select--pill":this.pill},onSlShow:this.handleMenuShow,onSlHide:this.handleMenuHide},i("sl-input",{slot:"trigger",part:"input",ref:t=>this.input=t,id:this.inputId,class:"select__input",name:this.name,value:this.displayLabel,disabled:this.disabled,pill:this.pill,placeholder:""===this.displayLabel&&0===this.displayTags.length?this.placeholder:null,readonly:!0,size:this.size,valid:this.valid,invalid:this.invalid,clearable:this.clearable,required:this.required,"aria-labelledby":this.labelId,"aria-describedby":this.helpTextId,onSlFocus:this.handleFocus,onSlBlur:this.handleBlur,onSlClear:this.handleClear,onKeyDown:this.handleKeyDown},this.displayTags.length&&i("span",{part:"tags",slot:"prefix",class:"select__tags"},this.displayTags),i("span",{part:"icon",slot:"suffix",class:"select__icon"},i("sl-icon",{name:"chevron-down"}))),i("sl-menu",{ref:t=>this.menu=t,part:"menu",class:"select__menu",onSlSelect:this.handleMenuSelect,onKeyDown:this.handleMenuKeyDown},i("slot",null))),i("div",{part:"help-text",id:this.helpTextId,class:{"help-text":!0,"help-text--small":"small"===this.size,"help-text--medium":"medium"===this.size,"help-text--large":"large"===this.size,"help-text--valid":this.valid,"help-text--invalid":this.invalid}},i("slot",{name:"help-text"})))}get host(){return l(this)}static get watchers(){return{multiple:["handleMultipleChange"],value:["handleValueChange"]}}};n.style=":host{position:relative;box-sizing:border-box}:host *,:host *:before,:host *:after{box-sizing:inherit}.form-control .label{display:none}.form-control--has-label .label{display:inline-block;color:var(--sl-input-label-color);margin-bottom:var(--sl-spacing-xxx-small)}.form-control--has-label .label.label--small{font-size:var(--sl-input-label-font-size-small)}.form-control--has-label .label.label--medium{font-size:var(--sl-input-label-font-size-medium)}.form-control--has-label .label.label--large{font-size:var(--sl-input-label-font-size-large)}.form-control--has-label .label.label--valid{color:var(--sl-input-label-color-valid)}.form-control--has-label .label.label--invalid{color:var(--sl-input-label-color-invalid)}.help-text{color:var(--sl-input-help-text-color)}.help-text.help-text--small{font-size:var(--sl-input-help-text-font-size-small)}.help-text.help-text--medium{font-size:var(--sl-input-help-text-font-size-medium)}.help-text.help-text--large{font-size:var(--sl-input-help-text-font-size-large)}.help-text.help-text--valid{color:var(--sl-input-help-text-color-valid)}.help-text.help-text--invalid{color:var(--sl-input-help-text-color-invalid)}.help-text ::slotted(*){margin-top:var(--sl-spacing-xxx-small)}:host{display:block}.select{width:100%}.select__input{flex:1 1 auto;width:100%}.select__input::part(input){cursor:pointer}.select__input span[slot=prefix]{margin-left:var(--sl-spacing-xx-small)}.select__input span[slot=prefix] sl-tag:not(:last-of-type){margin-right:var(--sl-spacing-xx-small)}.select__icon{display:inline-flex}.select__icon sl-icon{transition:var(--sl-transition-medium) transform ease}.select--open .select__icon sl-icon{transform:rotate(-180deg)}.select:not(.select--empty) .select__input::part(clear-button){visibility:visible}";export{n as sl_select}